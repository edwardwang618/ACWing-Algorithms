**Caveat：如无特殊说明，序列、数组、字符串、矩阵等等等等，下标都是从$1$开始的。这和计算机里数组下标从0开始的习惯有些不同，但代码写久了就会发现从$1$开始事实上更方便，可以避免很多边界的判断**





# 一维前缀和

给定一个长$n$的序列$a$，再给出若干询问，每次询问给一对正整数$l<r$，需要应答$\sum_{i=l}^r a[i]$



为了$O(1)$时间应答询问，我们可以构造一个“前缀和”数组$p$，使得$p[k]$恰好是$a$的前$k$项之和，那么

$\sum_{i=l}^r a[i]=p[r]-p[l-1]$



尝试构造$p$，按定义$p[0]=0$，$p[k]=p[k-1]+a[k]$，从而扫一遍$a$即可构造之。



例题：https://blog.csdn.net/qq_46105170/article/details/113793117



# 二维前缀和

考虑二维的情形，给定一个$n\times m$的矩阵$a$，每次询问想求某个子矩阵的和，子矩阵的左上坐标为$x_1,y_1$，右下坐标为$x_2,y_2$。



同上，为了快速应答询问，我们可以构造一个”二维前缀和“矩阵$s$，使得$s[x][y]=\sum_{i=1}^x\sum_{j=1}^y a[i][j]$，那么子矩阵和为：
$$s[x_2][y_2]-s[x_2][y_1-1]-s[x_1-1][y_2]+s[x_1-1][y_1-1]$$

考虑如何构造$s$，令$x_1=x_2=x,y_1=y_2=y$，则有
$$s[x][y]-s[x][y-1]-s[x-1][y]+s[x-1][y-1]=a[x][y]$$

移项得
$$s[x][y]=s[x][y-1]+s[x-1][y]-s[x-1][y-1]+a[x][y]$$

从而$s$可以由扫一遍$a$构造。



例题：https://blog.csdn.net/qq_46105170/article/details/113794146





# 作业

上面两道例题

ACWing 99 https://www.acwing.com/problem/content/101/









